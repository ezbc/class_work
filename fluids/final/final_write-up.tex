%-------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%-------------------------------------------------------------------------------

\documentclass{article}

% Packages
\input{my_packages.tex}

% formatting
\input{my_format.tex}

%----------------------------------------------------------------------------------------
%	NAME AND CLASS SECTION
%----------------------------------------------------------------------------------------

\newcommand{\hmwkTitle}{Final} % Assignment title
\newcommand{\hmwkDueDate}{Friday, May 16} % Due date
\newcommand{\hmwkClass}{Astron 702} % Course/class
\newcommand{\hmwkClassTime}{1:20 pm} % Class/lecture time
\newcommand{\hmwkClassInstructor}{Townsend} % Teacher/lecturer
\newcommand{\hmwkAuthorName}{Elijah Bernstein-Cooper} % Your name

%-------------------------------------------------------------------------------
%	TITLE PAGE
%-------------------------------------------------------------------------------

\title{\vspace{2in}
    \textmd{\textbf{\hmwkClass:\ \hmwkTitle}}\\
    \normalsize\vspace{0.1in}\small{Due\ on\ \hmwkDueDate}\\
    \vspace{0.1in}\large{\textit{\hmwkClassInstructor\ \hmwkClassTime}}
    \vspace{3in}}

\author{\textbf{Elijah Bernstein-Cooper}}
\date{\today} % Insert date here if you want it to appear below your name

%-------------------------------------------------------------------------------

\begin{document}

\maketitle
\newpage

%===============================================================================
%-------------------------------------------------------------------------------
%	PROBLEM 1
%-------------------------------------------------------------------------------
\begin{homeworkProblem}

    The Forward Time Backward Space (FTBS) is the only stable scheme in this
    case. Drawing from Courant stability analysis of linear advection flow, we
    found that for forward time schemes, only upwind schemes were stable.
    Downwind and center space schemes are unstable. The Burger's equation
    rising and falling states are analogous to positive flow in the linear
    advection flow. The FTBS scheme calculates flow using an upwind scheme and
    is thus stable. The Forward Time Center Space (FTCS) and Forward Time
    Forward Space (FTFS) schemes will always be unstable because they always
    samples downwind.

\end{homeworkProblem}
\clearpage
%===============================================================================


%===============================================================================
%-------------------------------------------------------------------------------
%	PROBLEM 2 
%-------------------------------------------------------------------------------
\begin{homeworkProblem}
    
    %---------------------------------------------------------------------------
    % FIGURE
    \begin{figure}[!ht]
    \begin{center}
        
        \includegraphics[width=0.75\columnwidth, resolution=600]{q2_rising.pdf}

        \caption{\label{fig:q2_rising} Snapshots of the rising state.}

    \end{center}
    \end{figure}
    %---------------------------------------------------------------------------

    %---------------------------------------------------------------------------
    % FIGURE
    \begin{figure}[!ht]
    \begin{center}
        
        \includegraphics[width=.75\columnwidth, resolution=600]{q2_falling.pdf}

        \caption{\label{fig:q2_falling} Snapshots of the falling state.}

    \end{center}
    \end{figure}
    %---------------------------------------------------------------------------

    \begin{homeworkSection}{i)}
    
        As shown in Figure~\ref{fig:q2_rising} the propagation speed of the
        head for the rising state is $x/t$ until the head reaches the tail at
        which point a discontinuity will propagate.  The tail is stationary.
        Referring to Figure $9.5$ in the notes, we can see that for initial
        states at $x = 1$, the characteristic curve has a slope of about 1.025
        $x/t$. The simulation is fairly accurate. For $x = -1$ the
        characteristic equation predicts that the velocity $u = 0$. This is
        exactly what we see.

    \end{homeworkSection}
    
    \begin{homeworkSection}{ii)}
  
        As shown in Figure~\ref{fig:q2_falling} we can see that the
        discontinuity develops at $t = 2$. Figure $9.10$ in the lecture notes
        predict this exact result at $x = 1$.

    \end{homeworkSection}

    \begin{homeworkSection}{iii)}
   
        The propagation speed, $S$, of the discontinuity developed at $t = 2$
        for the falling state is 0. The characteristic curves predict that $S >
        0$. Even though this scheme of finite-differencing is stable, the
        scheme is unable to conserve mass at a discontinuity thereby modeling a
        discontinuity poorly.

    \end{homeworkSection}


\end{homeworkProblem} \clearpage
%===============================================================================


%===============================================================================
%-------------------------------------------------------------------------------
%	PROBLEM 3
%-------------------------------------------------------------------------------
\begin{homeworkProblem}
    
    %---------------------------------------------------------------------------
    % FIGURE
    \begin{figure}[!ht]
    \begin{center}
        
        \includegraphics[width=0.75\columnwidth, resolution=600]{q3_rising.pdf}

        \caption{\label{fig:q3_rising} Snapshots of the rising state using the
        Gudonov method.}

    \end{center}
    \end{figure}
    %---------------------------------------------------------------------------

    %---------------------------------------------------------------------------
    % FIGURE
    \begin{figure}[!ht]
    \begin{center}
        
        \includegraphics[width=.75\columnwidth, resolution=600]{q3_falling.pdf}

        \caption{\label{fig:q3_falling} Snapshots of the falling state using
        the Gudonov method. The discontinuity is now able to propagate.}

    \end{center}
    \end{figure}
    %---------------------------------------------------------------------------

    Figure~\ref{fig:q3_falling} demonstrates that we have successfully
    reproduced the propagation of the discontinuity! The shock velocity whose
    discontinuity begins at $(x,t) = (1,2)$ will be $S = 1/2$. We reproduce
    this shock velocity.


\end{homeworkProblem} \clearpage
%===============================================================================

%===============================================================================
%-------------------------------------------------------------------------------
%	PROBLEM 4
%-------------------------------------------------------------------------------
\begin{homeworkProblem}

    %---------------------------------------------------------------------------
    % FIGURE
    \begin{figure}[!ht]
    \begin{center}
        
        \includegraphics[width=.75\columnwidth, resolution=600]{q4.pdf}

        \caption{\label{fig:q4} Snapshots of the falling state.}

    \end{center}
    \end{figure}
    %---------------------------------------------------------------------------

    We notice that the slope of the $Y(t)$ is 1/2, which we can attribute to
    the propagation speed $S$ being 1/2. The head begins at $y = 1$ and is
    growing in the positive $x$ direction. For each time unit in the falling
    state the head will drag more material into our integration interval $-2 <
    x < 6$ thus the integrated solution will be increasing by the propagation
    speed. The opposite is true for the rising state, where the head of the
    flow begins with $y = 0$, thus drags material out of our integration
    interval.

\end{homeworkProblem} \clearpage
%===============================================================================

%===============================================================================
%-------------------------------------------------------------------------------
%	PROBLEM 5
%-------------------------------------------------------------------------------
\begin{homeworkProblem}

    The Courant condition provides limits on the time and spatial resolution.
    The minimum distance a discontinuity can travel $\Delta x$ is given by

        \begin{equation}
            \Delta x > S \Delta t
        \end{equation}

    thus our time and spatial resolution will be limited by

        \begin{equation}\label{eq:courant}
            \frac{\Delta x}{\Delta t} > S
        \end{equation}

    and given $S = 0.5$ in our simulation our initial simulation parameters
    $\Delta x = 0.01$ and $\Delta t = 0.005$ satisfies this condition and our
    solution will be stable. Figures~\ref{fig:q5_falling} and
    ~\ref{fig:q5_rising} show results of an unstable simulation using the
    upwind scheme FTBS. 
    
    %---------------------------------------------------------------------------
    % FIGURE
    \begin{figure}[!ht]
    \begin{center}
        
        \includegraphics[width=.75\columnwidth, resolution=600]{q5_falling.pdf}

        \caption{\label{fig:q5_falling} Falling state with $\Delta x / \Delta t
        = 0.2$. The solution has become unstable because the Courant parameter
    is not satisfied as given in \ref{eq:courant} given that $S = 0.5$.}

    \end{center}
    \end{figure}
    %---------------------------------------------------------------------------

    %---------------------------------------------------------------------------
    % FIGURE
    \begin{figure}[!ht]
    \begin{center}
        
        \includegraphics[width=.75\columnwidth, resolution=600]{q5_rising.pdf}

        \caption{\label{fig:q5_rising} Rising state with $\Delta x / \Delta t
        = 0.2$. The solution has become unstable because the Courant parameter
    is not satisfied as given in \ref{eq:courant} given that $S = 0.5$.}

    \end{center}
    \end{figure}
    %---------------------------------------------------------------------------


\end{homeworkProblem} \clearpage
%===============================================================================


%===============================================================================
% Include Code here

\section{Simulation Code}

\pythonexternal{final.py}
%===============================================================================

\end{document}

